{% extends "base.html" %}
{% load humanize %}
{% block content %}
  <div class="container mt-4">
    <div class="row">
      <div class="col-md-6">
        {% if product.image %}
          <img src="{{ product.image.url }}" class="img-fluid" alt="{{ product.name }}">
        {% else %}
          <p>No image available.</p>
        {% endif %}
      </div>
      <div class="col-md-6">
        <h2>{{ product.name }}</h2>
        <p><small class="text-muted">Posted by: {{ product.seller.username }} on {{ product.created_at|date:"F d, Y" }}</small></p>
        <hr>

       <h4>Price: {{ product.price|intcomma }} Birr</h4>

<!-- --- ·ä†·ã≤·àµ ·ã®·àù·äï·å®·àù·à®·ãç ·ä≠·çç·àç --- -->
      {% if product.seller.profile.phone_number %}
  <div id="contact-section" class="mt-3 mb-3">
    <!-- ·àµ·àç·ä≠ ·âÅ·å•·à© ·àò·åÄ·àò·à™·ã´ ·àã·ã≠ ·â∞·ã∞·â•·âÜ ·ã≠·âÄ·àò·å£·àç -->
    <div id="contact-info" style="display:none;">
        <p class="fs-5"><strong>Phone:</strong> 
            <a href="tel:{{ product.seller.profile.phone_number }}">{{ product.seller.profile.phone_number }}</a>
        </p>
    </div>
    <!-- "Show contact" ·âÅ·àç·çç -->
    <button id="show-contact-btn" class="btn btn-success btn-lg">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-telephone-fill" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M1.885.511a1.745 1.745 0 0 1 2.61.163L6.29 2.98c.329.423.445.974.28 1.464l-2.094 2.094a.25.25 0 0 0 .03.341l2.32 2.32c.092.092.22.103.34.03l2.094-2.094a1.745 1.745 0 0 1 1.464.28l2.31 2.31c.262.262.163.742-.163 1.018l-1.313 1.313c-.329.329-.93.262-1.353-.163l-3.6-3.6a.25.25 0 0 0-.353 0l-3.6 3.6c-.423.425-1.024.492-1.353.163l-1.313-1.313a1.745 1.745 0 0 1 .163-2.61l2.31-2.31Z"/>
        </svg>
        Show Contact
    </button>
</div>
{% endif %}
<!-- --- ·ä†·ã≤·àµ ·ã®·àù·äï·å®·àù·à®·ãç ·ä≠·çç·àç ·ä•·ãö·àÖ ·ã´·â†·âÉ·àç --- -->
    <hr>
       <h5>Specifications</h5>
<!-- ... (·ã®·à∞·äï·å†·à®·ã° ·äÆ·ãµ ·ä•·äï·ã≥·àà ·ã≠·âÄ·å•·àã·àç) ... -->
        <table class="table table-striped">
           <tbody>
        {% if product.category %}
        <tr>
            <th scope="row">·àù·ãµ·â•</th>
            <td>{{ product.category.name }}</td>
        </tr>
        {% endif %}

        {% if product.brand %}
        <tr>
            <th scope="row">·ãì·ã≠·äê·âµ (Brand)</th>
            <td>{{ product.brand }}</td>
        </tr>
        {% endif %}

        {% if product.condition %}
        <tr>
            <th scope="row">·àÅ·äî·â≥ (Condition)</th>
            <td>{{ product.get_condition_display }}</td>
        </tr>
        {% endif %}

        {% if product.location %}
        <tr>
            <th scope="row">·ã®·àö·åà·äù·â†·âµ ·â¶·â≥</th>
            <td>{{ product.location }}</td>
        </tr>
        {% endif %}
    </tbody>
</table>

<hr>
<h5>Description</h5>
<p>{{ product.description|linebreaks }}</p>

<div class="mt-4">
    <form action="{% url 'like_product' product.id %}" method="POST" style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="btn btn-outline-primary">
            üëç Like <span class="badge bg-secondary">{{ product.total_likes }}</span>
        </button>
    </form>

    <form action="{% url 'dislike_product' product.id %}" method="POST" style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="btn btn-outline-secondary">
            üëé Dislike <span class="badge bg-secondary">{{ product.total_dislikes }}</span>
        </button>
    </form>
</div>
        <br>
        {% if product.seller == user %}
  <a href="{% url 'product_update' product.id %}" class="btn btn-warning">Edit</a>
  <a href="{% url 'product_delete' product.id %}" class="btn btn-danger">Delete</a>
{% endif %}
        <a href="{% url 'home' %}" class="btn btn-secondary">Back to Home</a>
        <hr>
        <h3>Related Products</h3>
        
<div class="row">
    {% for product in related_products %}
        <div class="col-md-3 col-6 mb-3">
            <div class="card h-100">
              {% if product.image %}
                <a href="{% url 'product_detail' product.id %}">
                    <img src="{{ product.image.url }}" class="card-img-top" alt="{{ product.name }}">
                </a>
              {% endif %}
              <div class="card-body">
                <a href="{% url 'product_detail' product.id %}">
                    <h5 class="card-title">{{ product.name }}</h5>
                </a>
                <p class="card-text">Price: {{ product.price }} Br.</p>
              </div>
            </div>
        </div>
    {% empty %}
        <p>No related products found.</p>
        <script>
    // "Show Contact" ·âÅ·àç·çç ·à≤·å´·äï ·ã®·àö·à∞·à´ ·äÆ·ãµ
    document.getElementById("show-contact-btn").addEventListener("click", function() {
        // ·àµ·àç·ä≠ ·âÅ·å•·à© ·ã´·àà·â†·âµ·äï ·ä≠·çç·àç ·ä†·à≥·ã≠
        document.getElementById("contact-info").style.display = "block";
        // ·âÅ·àç·çâ·äï ·ä•·à´·à±·äï ·ã∞·â•·âÄ·ãç
        this.style.display = "none";
    });
</script>
    {% endfor %} <!-- === ·àâ·çë ·ä•·ãö·àÖ ·â†·âµ·ä≠·ä≠·àç ·â∞·ãò·åç·â∑·àç === -->
</div>
  </div>
  {% endblock %}